<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GB168 Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    h1 {
      color: #222;
    }
  </style>
</head>
<body>
  <h1>Welcome to GB168 Tracker</h1>
  <p>Redirecting to Telegram... ⏳</p>

  <script>
    // ✅ Step 1: Extract UTM parameters from URL
    const urlParams = new URLSearchParams(window.location.search);
    const utm_source = urlParams.get('utm_source') || 'unknown';
    const utm_medium = urlParams.get('utm_medium') || 'unknown';
    const utm_campaign = urlParams.get('utm_campaign') || 'unknown';

    // ✅ Step 2: Prepare data to send
    const payload = {
      utm_source,
      utm_medium,
      utm_campaign,
      timestamp: new Date().toISOString()
    };

    // ✅ Step 3: Send data to Google Apps Script Web App
    fetch("https://script.google.com/macros/s/AKfycbwdTVcuPJflw2kG0Hgkb8t4YDSu7aPPfZxFT5o3_ILhb6Brsy3WjKySW7kT2JYbLKso7Q/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    })
    .then(res => res.text())
    .then(data => console.log("✅ Data sent successfully:", data))
    .catch(err => console.error("❌ Error sending data:", err));

    // ✅ Step 4: Redirect to Telegram after 3 seconds
    setTimeout(() => {
      window.location.href = "https://t.me/gb168mm1";
    }, 3000);
  </script>
</body>
</html>
